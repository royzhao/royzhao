<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Long</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="IF(I_FINISH_MY_WORK) { GOTO NEW_WORK; } ELSE { GOTO WORK_DAY_AND_NIGHT; }">
<meta property="og:type" content="website">
<meta property="og:title" content="Long">
<meta property="og:url" content="http://royzhao.github.io/index.html">
<meta property="og:site_name" content="Long">
<meta property="og:description" content="IF(I_FINISH_MY_WORK) { GOTO NEW_WORK; } ELSE { GOTO WORK_DAY_AND_NIGHT; }">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Long">
<meta name="twitter:description" content="IF(I_FINISH_MY_WORK) { GOTO NEW_WORK; } ELSE { GOTO WORK_DAY_AND_NIGHT; }">
  
    <link rel="alternative" href="/atom.xml" title="Long" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">培龙</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="http://github.com/royzhao" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/1837263552/" title="weibo">weibo</a>
					        
								<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhao-pei-long-66" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/storage/" style="font-size: 20px;">-storage</a> <a href="/tags/HA/" style="font-size: 10px;">HA</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">骚年，你好</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">培龙</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">培龙</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="http://github.com/royzhao" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/1837263552/" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="http://www.zhihu.com/people/zhao-pei-long-66" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-高可用理念" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/11/高可用理念/" class="article-date">
  	<time datetime="2015-12-11T00:05:42.000Z" itemprop="datePublished">2015-12-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/11/高可用理念/">高可用理念</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>  来自高可用架构群分享—by Coding CTO孙宇聪</p>
</blockquote>
<h2 id="1-怎样才算高可用">1.怎样才算高可用</h2><p><strong>前提：所有东西都有不可用的时候，所以得依靠一个指标来量化SLA。</strong><br>虽然大家一般都谈的是年SLA，但是年SLA除了对付客户之外，对工程上一般没有什么重要意义，google内部更加看重的是季度SLA，甚至到周，这样带来的挑战就更加大了。<br>可用级别如下图<br><img src="/assets/SLA.jpg" alt="SLA"><br>一般一个服务至少要做到3个9才能被成为基本可用，否则这个服务别人会很难使用。<br>从3个9到4个9是一个非常大的进步，一般来说到3个9是可以靠堆人搞定，但是从3个9向上靠人基本就是不行的了，这时候考验的就是业务的自愈能力，架构的容灾，容错设计，灾备系统的完备等等。  </p>
<h2 id="2-哪些方面才能影响SLA">2.哪些方面才能影响SLA</h2><p>引入两个指标<br><strong>MTBF:Mean time between Failures,表示一个服务多长时间坏一次</strong><br><strong>MTTR：Mean time to recover，表示一个服务一旦坏了，需要多长时间恢复</strong><br>有了这两个概念，我们就可以得到一个公式  </p>
<blockquote>
<p>  Availability =f(MTBF,MTTR) //MTBF与Availability正相关，MTTR与其负相关  </p>
</blockquote>
<p>根据这个公式，要提升一个服务的可用性，要么提升MTBF，要么降低MTTR。<br>如果一个服务MTBF非常高，比如一年只出一次问题，那么要达到4个9的要求就很好满足了只要你在52.6分钟之内恢复服务,那么你还是4个9的可用性。蛤蛤。<br>但是如果你的MTBF很低，比如一周坏一次，这种情况就只能从MTTR上下工夫了。  </p>
<blockquote>
<p>  孙宇聪：对于正常人来说，从受到突发警报然后到找到修复完成都是需要一定时间的，对于我2分钟能看清报警，就算是已知问题，有对应预备方案，能敲对命令，完全成功，也是要花15-20分钟，如果服务想要达到4个9,那么按照我这个标准，一年只能坏一次，再多就超标了，所以实现高可用基本靠运气(笑。  </p>
</blockquote>
<p><strong>所以MTTR都是有极限时间的。</strong><br>所以要提高高可用还是需要从MTBF下手。<br><strong>影响MTBF的因素</strong></p>
<ul>
<li>发布。  </li>
<li>发布。  </li>
<li>还是发布。<br>术语上这个叫做Age Mortality Risk，更新越频繁，那么出问题的可能性越大。<br>凡是software都有bug，修复bug的更新也可能会引入bug，所以MTBF最大的敌人就是发布心版本。<h2 id="3-如何落地提高高可用性">3.如何落地提高高可用性</h2>方案：<br>1) 提高冗余度，多实例运行。用资源换可用性。  </li>
</ul>
<p>虽然道理很简单，但是实现起来并不简单，有很多细节需要考虑。  </p>
<p>细节1: N+2应该是标配。N+2的意思是如果一个服务需要一个实例正常提供服务，那么生产环境上应该部署1+2=3个节点。可能大家囧的N+1比较合理，能够提供热备容灾，但是我们在发布的时候备份节点就成为了单点了，这个时候出了问题，那么我们的服务就不可用了，所以这个才是N+2的意义所在。 <strong>而且，发布成功的机率不高</strong>,从另一个角度讲N+2可以在丢失最大的实例的同时依然可以保证服务的运行，有点像两地三中心的概念。<br>细节2: 实例之间要对等，独立，不要搞一大一小，相互依赖，否则你的N+2就不是真正的N+2，如果两地三中心的一个中心需要24小时才能迁移过去，那他就不是一个高可用部署，还是叫做异地灾备系统吧。<br>细节3: 流量控制能力非常重要。要想做到高可用就必须有一套非常可靠的流量控制系统。为什么呢？原因是高可用系统必须要支持以下几种场景：  </p>
<ul>
<li>Isolation<br>不同用户发来的请求同时处理可能会有冲突，他们之间所以需要隔离，隔离就需要识别这些流量。  </li>
<li>Quarantine<br>一些用户发来的请求可能资源消耗超标，必须将这些请求钉死在某几个节点上以便顾全大局，所以需要识别这样的流量  </li>
<li>Query of death<br>上线之后一个用户发来请求直接搞挂服务，要是连续来几次可能整个集群都挂了，这样就不能实现高可用了，针对这种情况，所以需要对这种流量进行识别自动屏蔽。  </li>
</ul>
<p>综上所述，流量控制系统对HA是必不可少的，而且最好按照业务维度来划分，比如按照API，用户类型，用户来源来调度。  </p>
<p>2) 变更管理<br>发布质量不提高，一切都是空谈。<br>第一点：线下测试（offline test）  </p>
<p>线下测试永远比线上测调试容易一百倍，也安全一百倍。</p>
<blockquote>
<p> 孙宇聪：如果各位的团队还没有完整的线下测试环境，那么我的意见是先不要接新业务了，花点时间把这个搞定。</p>
</blockquote>
<p>其中包括代码测试，数据兼容测试，压力测试等等，可用性的阶段性提升，不是靠运维团队，而是靠产品团队。   </p>
<p>第二点： 灰度发布  </p>
<p>这个灰度发布具体实施起来也是很有讲究的，他是速度与安全的妥协，他是发布众多保险的最后一道，而不是唯一的一道。如果只是为了灰度而灰度，故意认为的拖慢进度，反而造成线上多个版本长期共存，可能会引入心的问题。  </p>
<p>做灰度发布如果是匀速的，说明没有理解灰度发布的意义，一般来说阶段选择上从1%-&gt;10%-&gt;100%的指数型增长，这个阶段是根据具体业务不同按唯独去细分的。这里的重点在于1%并不全是按随机选择的，而是根据业务特点，数据特点选择的具有代表性的实例，去做灰度发布的小白鼠，甚至每次发布的第一阶段的用户（Canary）都是根据每次发布的特点不同，人为挑选的，比如发布一个只给亚洲用户使用的功能，那么用美国或者欧洲的集群来做发布实验是没有什么意义的。灰度发布真的不只是按机器划分这么简单。  </p>
<p>本质上灰度发布就是上线的最后一道安全防护机制，首先不能过慢，让产品团队过度依赖，也不能过于随机失去了他的意义，总之灰度发布，全部都在细节里。  </p>
<p>第三点： 服务必须对回滚提供支持  </p>
<p>不能回滚的理由各种各样，下面分享三条秘籍，保证药到病除。<br>理由1:我这个数据改动之后格式和以前不兼容了，回退也不能回复到正常。<br>秘籍1:设计开发的时候就要考虑好兼容性问题！！比如数据库改字段的事儿就不要做，改成另加一个字段就好。数据存储格式就最好采用protobuf这种支持数据版本，支持前后兼容性的方案，最差最差也要在变更实施“之前”想清楚数据兼容性的问题，没有回滚脚本，不给更新，做到有备而战。  </p>
<p>理由2:我变更删除东西了，滚回去也没有用了。<br>秘籍2:把变更打回去，分成凉拌，第一半禁止访问这个数据，等到发布之后没有问题了，再来发布第二半，这个时候真正删掉数据，这样子实施第一半之后，需要回滚还可以滚回去。  </p>
<p>理由3:我的变更发布之后，以来这个系统的人都拿到了错误的数据，回退也没有用了，他们不接受老数据了。<br>秘籍3:这种问题常常出现在配置管理，缓存等系统中，对于这种问题，最重要的就是开发出一种和版本无关的刷新机制，出发刷新的机制应该独立于发布过程，有一个强制刷新数据的手段。   </p>
<h2 id="可用性级别">可用性级别</h2><p>第一级：crash with data corruption destruction<br>  内存数据库就是这样，出个意外，数据都没有了。写硬盘到一般，挂了之后，不光是进程内数据没了，老数据都掉完了。<br>第二级：Crash with new data loss<br>  一般来说正常的服务都应做到这一点，挂了之后最多丢个几秒的数据。<br>第三级：Crash without data loss<br>  好一点的服务应该都做到这一级别了，要达到这一级别需要一定的技术投入，起码搞清楚如何绕过os的各种cache，绕过硬件的各种坑，有一定难度。<br>第四级：No Crash,but with no or limited service, low service quality of service.<br>  做的好一点的系统，不要动不动就崩溃了，一个程序如果能够正常处理异常输入，异常数据等，那么就给刚刚提到的流量控制系统创造了条件，可以把其他用户的流量导入过来，把问题流量发到一边去，不会造成太大的容量损失。<br>第六级：Failover with significant user visible delay, near full quality of service<br>  到了这一级别才摸到高可用的门，也就是有容灾措施，但是可能自动化程度不高，或者一些关键问题没有解决，所以业务能恢复，但是就是比较慢。<br>第七级：Failover with minimal to none user visible delay, near full qulity of service.<br>  南翔一铲子下去，你的服务依然没有影响，高可用就是这个样子的。  </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/HA/">HA</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-RAID介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/12/01/RAID介绍/" class="article-date">
  	<time datetime="2015-12-01T03:26:25.000Z" itemprop="datePublished">2015-12-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/12/01/RAID介绍/">RAID0~6</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="名词">名词</h3><ul>
<li>stripee：不同磁盘相同偏移的位置被称为strpee</li>
<li>segement：一个strpee在同一个磁盘上占用的区域叫做segement</li>
<li>stripee depth：一个segement包含的扇区数叫做stripee depth<h3 id="IOPS计算公式">IOPS计算公式</h3>存储系统的IOPS指标当然是高的好，公式如下<br>IOPS=IO并发系数/（一次IO服务时间）<h3 id="传输效率与并发IO的矛盾">传输效率与并发IO的矛盾</h3>一次IO如果可以尽可能的使用多的磁盘获取数据，那么这次的IO必然节省数据的传输时间，让数据均匀分布到各个磁盘，那就只有将stripee depth变小<br>如果需要传输效率高，那么一次IO会占用多个磁盘，那么后面来的IO请求只有在队列中等待，要想提高并发IO，那么只能让一次IO尽可能的少占用磁盘，最好一个IO占用一个。<h3 id="RAID0">RAID0</h3></li>
<li><p>优点：能够整合多块磁盘，提高单词IO的效率</p>
</li>
<li><p>缺点：<br>1)没有安全措施，一旦其中某个磁盘坏掉，整个阵列都将不可用  </p>
</li>
</ul>
<h3 id="RAID1">RAID1</h3><ul>
<li>优点：使用备份技术，损坏一个磁盘，备份磁盘可以顶上，同时因为备份盘和数据盘一样，所以可以实现并发IO，可以提升读效率  </li>
<li>缺点：写时需要同时写备份盘，写效率降低  <h3 id="RAID2">RAID2</h3></li>
<li>优点：独立使用校验盘，使用汉明码对数据进行校验，不用担心损坏一块盘导致阵列报废；由于RAID2是以bit为粒度存储，所以对于单个IO，可以把传输效率提升N倍（N为数据盘个数）</li>
<li>缺点：校验盘较多，因为使用汉明码，所以随着数据盘的增加，相应也要增加校验盘。由于每次IO都要占用所有的磁盘，所以他不能实现并发IO。<h3 id="RAID3">RAID3</h3></li>
<li>优点：使用XOR方式来进行校验数据，所以无论有多少个数据盘只需要一个校验盘就行。对于单个IO，可以把传输效率提升N倍。</li>
<li>缺点：依然要使用独立的校验盘，不能够实现并发IO<h3 id="RAID4">RAID4</h3>只要让单次IO有空闲磁盘，那么就有可能实现并发IO，所以只要保证一次IO少于stripe size那么就可以让一次IO少占用磁盘。但是RAID4中还是共享校验盘的，校验盘成为独享资源，所以RAID4都快没有了。<h3 id="RAID5">RAID5</h3>RAID5解决了RAID4中竞争校验盘的问题，RAID5取消了校验盘，把校验数据分散到了各个数据盘中。</li>
<li>优点：解决了校验盘竞争的问题，实现了并发IO</li>
<li>缺点：只要损坏了两个及以上的数据盘，那么阵列就跪了<h3 id="RAID6">RAID6</h3>RAID6根据多元一次方程的原理实现了防止多块数据盘损坏导致系统不可用的情况。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-The Law of disk preformance" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/30/The Law of disk preformance/" class="article-date">
  	<time datetime="2015-11-30T03:26:25.000Z" itemprop="datePublished">2015-11-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/30/The Law of disk preformance/">The Law of disk preformance</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>简化模型  </p>
<p>arrival rate：应用每个时间内到达controller的I/O请求数。<br>响应时间：一个请求从发出到处理结束的时间。<br>Little’s Law：<br>表示队列中的请求数及响应时间的关系。<br>N=a <em> R （1)<br>N：队列系统中的所有的请求数（控制器中正在处理的请求以及队列中的请求）<br>a：arrival rate，单元时间内到达系统的请求数<br>R：平均响应时间，或者每个I/O请求的周转时间—一个请求到达系统一直到离开系统所花销的时间。<br>Utilization law：<br>这个是用来定义I/O controller的能力<br>U = a </em> R_s<br>U: I/O controller的处理能力<br>a： arrival rate<br>R_s：服务时间（service time），请求在controller中花费的平均时间，1/R_s被称作服务率。<br>R_a：可以表示为到达间隔时间（R_a = 1/a）<br>所以<br>U=R_s/R_a(0&lt;=U&lt;=1)<br>其中a&lt;1/R_s,如果不这样的话，那么系统会处理不过来。<br>定义S（average response rate）<br>S = service rate - arrival rate<br>R = 1/S<br>  = 1/(service rate - arrival rate）<br>  = 1/（1/R_s - 1/R_a）<br>  = 1/(1/R_s - a)<br>  = R_s/(1-a*R_s)</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-硬盘" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/26/硬盘/" class="article-date">
  	<time datetime="2015-11-26T03:33:19.000Z" itemprop="datePublished">2015-11-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/硬盘/">硬盘</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>硬盘使用快速移动的机械手臂来读/写取磁片上面的数据<br>硬盘的组建有<br>    platter（磁片），spindle，r/w head，actuator arm assembly，contorller<br><img src="/assets/disk.png" alt="硬盘结构"></p>
<h3 id="Platter">Platter</h3><p>一个硬盘一般存在一个或者多个圆形碟片（platters）<br><img src="/assets/platter.png" alt="Spindle and Platter"><br>这么多的platters封装在一个盒子里面，叫做Head Disk Assembly（HDA）  </p>
<h3 id="Spindle">Spindle</h3><p>Spindle把所有的Platters连接起来，并且它和motor（马达）相连接，这样就可以愉快的转起来了。<br>一般都可以转数千个Revolutions per minute（RPM）</p>
<h3 id="R/W_Head">R/W Head</h3><p><img src="/assets/RW.png" alt="R/W Head"><br>每一面都有读写头，读写头可以改变磁片的磁极，读写头并没有直接碰着磁片，他们有一个距离叫做head flying height，只要磁片转起来，带动的空气会让磁头飞起来。</p>
<h3 id="Actuator_Arm_Assembly">Actuator Arm Assembly</h3><p>读写头就被绑在这个东西上面</p>
<h3 id="Controller">Controller</h3><p>Contoller是被印刷在电路板上，由微处理器以及内存，电路和固件组成，固件控制这Spindle马达的电源和速度。它可以和主机通信，也可以控制机械手臂，来优化数据访问。  </p>
<h3 id="硬盘物理结构">硬盘物理结构</h3><p>数据被记录在磁道（tracks）上，磁道从0开始编号，从里到外依次增加，每一个磁道都被划分为若干个小块，每个小块叫做扇区（sectors），扇区是最小的存储单元，下图是硬盘结构<br><img src="/assets/disk-structure.png" alt="disk structutr"><br>一般来说一个扇区可以保存512B的数据，综上，数据的存储位置可以有三个坐标来确定：<br>扇面号，磁道号，扇区号。当然存储这些信息也是需要空间的,所以一般我们都不可能把磁盘空间占满。<br>cylinder就是用来定位盘面上面有多少个磁道</p>
<h3 id="数据定位">数据定位</h3><p>早期的硬盘使用CHS号定位（Cylinder，head，sector）如下图(a)<br><img src="/assets/address.png" alt="address"><br>LBA(Logical Block Addressing)直接屏蔽了CHS繁琐的问题，把硬盘直接当成一个线性的地址，硬盘控制器会把LBA转换为CHS，然后在访问，上层应用不用关心CHS了</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-存储系统环境" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/26/存储系统环境/" class="article-date">
  	<time datetime="2015-11-26T03:26:25.000Z" itemprop="datePublished">2015-11-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/存储系统环境/">存储系统环境</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是存储系统环境（Storage_System_Environment）">什么是存储系统环境（Storage System Environment）</h3><p>数据流从应用到存储经过的所有的不同的组建集合叫做存储系统环境<br>三个主要有组建有：</p>
<ul>
<li>host</li>
<li>connectivity</li>
<li>storage</li>
</ul>
<p>这章主要讲：<br>1) 硬件部分</p>
<ul>
<li>硬盘，disk geometry（寻址，包括磁头，柱面，扇区），管理方式  </li>
<li>总线技术及协议接口（关于存储设备与host的连接）<br>2) 逻辑部分</li>
<li>主机（文件系统：file system，卷管理volume managers，操作系统：operating systems以及他们在存储系统环境中所处的位置）</li>
</ul>
<h3 id="Host">Host</h3><p>负责运行用户处理数据的应用程序的机器叫做Host<br>Host范围很广，可以从笔记本电脑到复杂的服务集群。<br>Host可以简单分为物理组件和逻辑组件</p>
<h4 id="物理组件">物理组件</h4><ul>
<li>CPU</li>
<li>Storage（硬盘或者内存）</li>
<li>I/O设备<br>物理组件一般总共总线（BUS）通信。<br>下面记录一下I/O设备类型<br>1) 主机/用户通信，比如键盘，鼠标，显示器等<br>2) 主机/主机通信，比如网卡，modem<br>3) 主机/存储设备通信，主要是使用Host Bus Adaptor（HBA），HBA是一个电路板，他主要是解决CPU和存储设备的IO速率不匹配的问题   <h3 id="Connectivity（host和storage的连接）">Connectivity（host和storage的连接）</h3>在存储系统环境中的host和storage连接也可以分为物理和逻辑，物理就是具体连接host到storage的硬件，逻辑就是host到storage的通信协议。<h4 id="硬件组成">硬件组成</h4>Bus，Port，Cable<br><img src="/assets/physical-connectivity.png" alt=""><br>其中bus主要可以分为：<br>1)系统总线<br>  主要是cpu与内存的交互<br>2)Local or I/O总线<br>  主要是处理器和外部设备的交互<h4 id="逻辑组成">逻辑组成</h4>local bus上最流行的协议就是PCI（peripheral component interconnect）<br>和硬盘连接的一般是IDE（Intgrated Device Electronics）/ATA(Advanced Technology Attachment)以及SCSI（Small Computer System Interface）。  </li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Storage System Environment" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/26/Storage System Environment/" class="article-date">
  	<time datetime="2015-11-26T01:41:13.000Z" itemprop="datePublished">2015-11-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/26/Storage System Environment/">Storage System Environment</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="什么是存储系统环境（Storage_System_Environment）">什么是存储系统环境（Storage System Environment）</h3><p>数据流从应用到存储经过的所有的不同的组建集合叫做存储系统环境<br>三个主要有组建有：</p>
<ul>
<li>host</li>
<li>connectivity</li>
<li>storage</li>
</ul>
<p>这章主要讲：<br>1) 硬件部分</p>
<ul>
<li>硬盘，disk geometry（寻址，包括磁头，柱面，扇区），管理方式  </li>
<li>总线技术及协议接口（关于存储设备与host的连接）<br>2) 逻辑部分</li>
<li>主机（文件系统：file system，卷管理volume managers，操作系统：operating systems以及他们在存储系统环境中所处的位置）</li>
</ul>
<h3 id="Host">Host</h3><p>负责运行用户处理数据的应用程序的机器叫做Host<br>Host范围很广，可以从笔记本电脑到复杂的服务集群。<br>Host可以简单分为物理组件和逻辑组件</p>
<h4 id="物理组件">物理组件</h4><ul>
<li>CPU</li>
<li>Storage（硬盘或者内存）</li>
<li>I/O设备<br>物理组件一般总共总线（BUS）通信。<br>下面记录一下I/O设备类型<br>1) 主机/用户通信，比如键盘，鼠标，显示器等<br>2) 主机/主机通信，比如网卡，modem<br>3) 主机/存储设备通信，主要是使用Host Bus Adaptor（HBA），HBA是一个电路板，他主要是解决CPU和存储设备的IO速率不匹配的问题   <h3 id="Connectivity（host和storage的连接）">Connectivity（host和storage的连接）</h3>在存储系统环境中的host和storage连接也可以分为物理和逻辑，物理就是具体连接host到storage的硬件，逻辑就是host到storage的通信协议。<h4 id="硬件组成">硬件组成</h4>Bus，Port，Cable<br><img src="/assets/pyhsical-connectivity.png" alt=""><br>其中bus主要可以分为：<br>1)系统总线<br>  主要是cpu与内存的交互<br>2)Local or I/O总线<br>  主要是处理器和外部设备的交互<h4 id="逻辑组成">逻辑组成</h4>local bus上最流行的协议就是PCI（peripheral component interconnect）<br>和硬盘连接的一般是IDE（Intgrated Device Electronics）/ATA(Advanced Technology Attachment)以及SCSI（Small Computer System Interface）。  </li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-存储发展" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/25/存储发展/" class="article-date">
  	<time datetime="2015-11-25T01:41:13.000Z" itemprop="datePublished">2015-11-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/25/存储发展/">存储发展</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="/assets/evolution of storage.png" alt=""></p>
<h2 id="存储发展">存储发展</h2><h3 id="最初阶段">最初阶段</h3><p>存储设备是放在服务器里面的，随着组织的服务器数目增加，这种方式导致了对数据的不可保护，不可管理，信息孤岛以及增加了操作花销，针对这样的问题，存储技术从非智能的内部存储向智能化的网络存储发展。</p>
<h3 id="主要包括">主要包括</h3><ul>
<li>RAID（Redundant Array of Independent Disks）  </li>
</ul>
<p>这种技术主要解决数据的性能，花销以及可用性等需求，如今这个技术已经用在了所有的存储架构中</p>
<ul>
<li>Direct-attached storage(DAS)  </li>
</ul>
<p>这种存储技术是直连服务器，他可以放在服务器的内部也可以放在外部，放在外部的DAS可以减少服务器内部空间</p>
<ul>
<li>Storage area network（SAN）<br>这种技术是解决服务器与存储设备的块级别的通信，主要给予Fibre Channel网络（这个是一个高效的传输网络），SAN从服务器中分离出来，SAN了高效的，可扩展的，高可用</li>
<li>Network-attached storage（NAS）<br>这技术主要解决的是文件服务，不同于SAN，这个是可以通过任意的LAN进行访问，兼容了异构的客户端</li>
<li>Internet Protocol SAN（IP-SAN）<br>这个是SAN和NAS的融合，他是提供块级别的数据传输，不过可以使用LAN或者WAN来访问</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-存储入门" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/11/23/存储入门/" class="article-date">
  	<time datetime="2015-11-23T09:29:31.000Z" itemprop="datePublished">2015-11-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/23/存储入门/">存储入门</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p>第一章</p>
<p>1)信息增长的挑战<br>2)存储系统的定义<br>3)存储系统的发展历史<br>4)智能存储系统</p>
</li>
<li>存储类型以及协议<br> 1)SCSI，Fibre channel架构<br> 2)direct-attached storage（DAS）<br> 3)storage area networks（SANs）<br> 4)network-attached storage（NAS）<br> 5)Internet Protocol SAN（IP-SAN）<br>6)Content-addressed storage(CAS)<br>7)storage virtualization</li>
<li><p>业务持久和复制<br> 1)业务持久<br> 2)备份和恢复<br> 3)本地数据复制及远程数据复制</p>
</li>
<li><p>安全与管理<br> 1)存储安全<br> 2)基础监控和管理</p>
</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/storage/">-storage</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-plan" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/09/20/plan/" class="article-date">
  	<time datetime="2015-09-20T11:52:45.000Z" itemprop="datePublished">2015-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/09/20/plan/">plan</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Todo_List">Todo List</h1><h3 id="2015-9-20~2015-9-27">2015.9.20~2015.9.27</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">servlet</span>相关</span><br><span class="line"><span class="label">Tcp</span>/<span class="literal">Ip</span>协议</span><br><span class="line">白板编程训练</span><br></pre></td></tr></table></figure>
<figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Definition <span class="keyword">for</span> singly-linked list.</span><br><span class="line"> * <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListNode</span> &#123;</span></span><br><span class="line"> *     int val;</span><br><span class="line"> *     ListNode <span class="keyword">next</span>;</span><br><span class="line"> *     ListNode(int x) &#123; val = x; &#125;</span><br><span class="line"> * &#125;</span><br><span class="line"> */</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span> ListNode sortList(ListNode head) &#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(head.<span class="keyword">next</span> == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode l,r;</span><br><span class="line">        ListNode p1,p2;</span><br><span class="line">        l= head;</span><br><span class="line">        r= head;</span><br><span class="line">        p1= head;</span><br><span class="line">        p2 = head;</span><br><span class="line">        <span class="keyword">while</span>(p2 != <span class="literal">null</span>)&#123;</span><br><span class="line">            p2 = p2.<span class="keyword">next</span>;</span><br><span class="line">            <span class="keyword">if</span>(p2 != <span class="literal">NULL</span>)&#123;</span><br><span class="line">                p2 = p2.<span class="keyword">next</span>;</span><br><span class="line">                p1 = p1/<span class="keyword">next</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        r = p1.<span class="keyword">next</span>;</span><br><span class="line">        p1.<span class="keyword">next</span> = <span class="literal">null</span>;</span><br><span class="line">        //<span class="keyword">end</span></span><br><span class="line">        ListNode left = sortList(l);</span><br><span class="line">        ListNode right = sortList(r);</span><br><span class="line">        //merge</span><br><span class="line">        ListNode pHead = <span class="literal">null</span>;</span><br><span class="line">        ListNode last = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span>(left != <span class="literal">null</span> &amp;&amp; right != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(left.val &gt;= right.val)&#123;</span><br><span class="line">                last = right;</span><br><span class="line">                right = right.<span class="keyword">next</span>;</span><br><span class="line">                </span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                last = left;</span><br><span class="line">                left = left.<span class="keyword">next</span>;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            last.<span class="keyword">next</span> = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span>(pHead == <span class="literal">null</span>)&#123;</span><br><span class="line">                pHead = last;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pHead.<span class="keyword">next</span> = last;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(right != <span class="literal">null</span>)&#123;</span><br><span class="line">            last.<span class="keyword">next</span> = right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(left != <span class="literal">null</span>)&#123;</span><br><span class="line">            last.<span class="keyword">next</span> = left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pHead;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/2015/">2015</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/07/17/hello-world/" class="article-date">
  	<time datetime="2015-07-17T01:08:40.000Z" itemprop="datePublished">2015-07-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/17/hello-world/">Hello World</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="http://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="http://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="http://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick_Start">Quick Start</h2><h3 id="Create_a_new_post">Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run_server">Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate_static_files">Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy_to_remote_sites">Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="http://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 培龙
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>